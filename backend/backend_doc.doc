package minecraft // import "github.com/ZiplEix/crafteur/minecraft"


FUNCTIONS

func LoadProperties(path string) (map[string]string, error)
    LoadProperties reads a server.properties file and returns a map of
    key-values

func SaveProperties(path string, props map[string]string) error
    SaveProperties writes the properties map to the file with a standard header


TYPES

type BanEntry struct {
	UUID    string `json:"uuid"`
	Name    string `json:"name"`
	Created string `json:"created"`
	Source  string `json:"source"`
	Expires string `json:"expires"`
	Reason  string `json:"reason"`
}

type Instance struct {
	ID       string
	RunDir   string
	JarName  string
	JavaArgs []string

	ConnectedPlayers map[string]bool
	// Has unexported fields.
}

func NewInstance(id string, runDir, jarName string) *Instance

func (i *Instance) GetHistory() []string

func (i *Instance) GetStatus() core.ServerStatus

func (i *Instance) IsPlayerOnline(name string) bool
    Helper to check if player is online

func (i *Instance) SendCommand(cmd string) error

func (i *Instance) SetStatus(status core.ServerStatus)

func (i *Instance) Start() error

func (i *Instance) Stop() error

func (i *Instance) Subscribe() chan WSMessage

func (i *Instance) Unsubscribe(ch chan WSMessage)

type Manager struct {
	// Has unexported fields.
}

func NewManager() *Manager

func (m *Manager) AddInstance(id string, runDir, jarName string) *Instance

func (m *Manager) GetInstance(id string) (*Instance, bool)

func (m *Manager) RemoveInstance(id string)

type OpEntry struct {
	UUID  string `json:"uuid"`
	Name  string `json:"name"`
	Level int    `json:"level"`
}

type PlayerCacheEntry struct {
	Name      string `json:"name"`
	UUID      string `json:"uuid"`
	ExpiresOn string `json:"expiresOn"`
}

type WSMessage struct {
	Type string `json:"type"`
	Data string `json:"data"`
}

package database // import "github.com/ZiplEix/crafteur/database"


VARIABLES

var DB *sql.DB

FUNCTIONS

func CreateServer(s *core.ServerConfig) error
func CreateTask(task *core.ScheduledTask) error
func CreateUser(u *core.User) error
func DeleteServer(id string) error
func DeleteTask(id string) error
func GetAllServers() ([]core.ServerConfig, error)
func GetAllTasks() ([]core.ScheduledTask, error)
func GetServer(id string) (*core.ServerConfig, error)
func GetTasksByServer(serverID string) ([]core.ScheduledTask, error)
func GetUserByID(id string) (*core.User, error)
func GetUserByUsername(username string) (*core.User, error)
func InitDB()
func UpdateLastRun(id string, lastRun time.Time) error
package core // import "github.com/ZiplEix/crafteur/core"


FUNCTIONS

func CreateEula(serverDir string) error
func DownloadFile(url string, destPath string) error
func EnsureDir(path string) error

TYPES

type AuthResponse struct {
	Token string `json:"token"`
}

type LoginRequest struct {
	Username string `json:"username"`
	Password string `json:"password"`
}

type ScheduledTask struct {
	ID             string    `json:"id"`
	ServerID       string    `json:"server_id"`
	Name           string    `json:"name"`
	Action         string    `json:"action"`          // "start", "stop", "restart", "command"
	Payload        string    `json:"payload"`         // Command to execute
	CronExpression string    `json:"cron_expression"` // e.g., "0 10 * * *" or "@every 1h"
	OneShot        bool      `json:"one_shot"`        // If true, delete after execution
	LastRun        time.Time `json:"last_run"`
	NextRun        time.Time `json:"next_run"` // Not stored in DB
}

type ServerConfig struct {
	ID          string     `json:"id"`
	Name        string     `json:"name"`
	Type        ServerType `json:"type"`
	Port        int        `json:"port"`
	RAM         int        `json:"ram"`
	JavaVersion int        `json:"java_version"`
}

type ServerDetailResponse struct {
	ID          string       `json:"id"`
	Name        string       `json:"name"`
	Type        ServerType   `json:"type"`
	Port        int          `json:"port"`
	RAM         int          `json:"ram"`
	JavaVersion int          `json:"java_version"`
	Status      ServerStatus `json:"status"`
}

type ServerStatus string

const (
	StatusStopped  ServerStatus = "STOPPED"
	StatusStarting ServerStatus = "STARTING"
	StatusRunning  ServerStatus = "RUNNING"
	StatusStopping ServerStatus = "STOPPING"
)
type ServerType string

const (
	TypeVanilla ServerType = "vanilla"
	TypeFabric  ServerType = "fabric"
)
type User struct {
	ID           string `json:"id"`
	Username     string `json:"username"`
	PasswordHash string `json:"-"`
}

package controller // import "github.com/ZiplEix/crafteur/controller"


FUNCTIONS

func Login(c echo.Context) error
func Logout(c echo.Context) error
func Me(c echo.Context) error

TYPES

type BackupController struct {
	// Has unexported fields.
}

func NewBackupController(backupService *services.BackupService) *BackupController

func (c *BackupController) CreateBackup(ctx echo.Context) error

func (c *BackupController) DeleteBackup(ctx echo.Context) error

func (c *BackupController) DownloadBackup(ctx echo.Context) error

func (c *BackupController) ListBackups(ctx echo.Context) error

type CreateServerRequest struct {
	Name string          `json:"name"`
	Type core.ServerType `json:"type"`
	Port int             `json:"port"`
	RAM  int             `json:"ram"`
}
    POST /api/servers

type FileController struct {
	// Has unexported fields.
}

func NewFileController(fileService *services.FileService) *FileController

func (ctrl *FileController) CreateDirectory(c echo.Context) error

func (ctrl *FileController) DeletePath(c echo.Context) error

func (ctrl *FileController) ListFiles(c echo.Context) error

func (ctrl *FileController) Unzip(c echo.Context) error

func (ctrl *FileController) UploadFile(c echo.Context) error

type LogController struct {
	// Has unexported fields.
}

func NewLogController(logService *services.LogService) *LogController

func (c *LogController) GetLogContent(ctx echo.Context) error

func (c *LogController) ListLogs(ctx echo.Context) error

type PlayerActionRequest struct {
	PlayerName string `json:"player"`
	Action     string `json:"action"` // op, deop, ban, pardon, kick, whitelist_add, whitelist_remove
	Reason     string `json:"reason,omitempty"`
}

type PlayerController struct {
	// Has unexported fields.
}

func NewPlayerController(ps *services.PlayerService, ss *services.ServerService) *PlayerController

func (c *PlayerController) GetBanned(ctx echo.Context) error

func (c *PlayerController) GetCache(ctx echo.Context) error

func (c *PlayerController) GetOps(ctx echo.Context) error

func (c *PlayerController) HandleAction(ctx echo.Context) error

type SchedulerController struct {
	// Has unexported fields.
}

func NewSchedulerController(schedulerService *services.SchedulerService) *SchedulerController

func (c *SchedulerController) CreateTask(ctx echo.Context) error

func (c *SchedulerController) DeleteTask(ctx echo.Context) error

func (c *SchedulerController) ListTasks(ctx echo.Context) error

type ServerController struct {
	// Has unexported fields.
}

func NewServerController(s *services.ServerService) *ServerController

func (ctrl *ServerController) Command(c echo.Context) error
    POST /api/servers/:id/command

func (ctrl *ServerController) Console(c echo.Context) error
    WS /api/servers/:id/ws

func (ctrl *ServerController) Create(c echo.Context) error

func (ctrl *ServerController) GetOne(c echo.Context) error
    GET /api/servers/:id

func (ctrl *ServerController) GetProperties(c echo.Context) error
    GET /api/servers/:id/properties

func (ctrl *ServerController) Index(c echo.Context) error
    GET /api/servers

func (ctrl *ServerController) Start(c echo.Context) error
    POST /api/servers/:id/start

func (ctrl *ServerController) Stop(c echo.Context) error
    POST /api/servers/:id/stop

func (ctrl *ServerController) UpdateProperties(c echo.Context) error
    POST /api/servers/:id/properties

package services // import "github.com/ZiplEix/crafteur/services"


VARIABLES

var SecretKey = []byte("super_secret_key_crafteur")

FUNCTIONS

func Login(username, password string) (string, error)
func Register(username, password string) error

TYPES

type BackupEntry struct {
	Name      string    `json:"name"`
	Size      int64     `json:"size"`
	CreatedAt time.Time `json:"created_at"`
}

type BackupService struct {
	// Has unexported fields.
}

func NewBackupService(sourcePath, backupPath string) *BackupService

func (s *BackupService) CreateBackup(serverID string) error

func (s *BackupService) DeleteBackup(serverID, filename string) error

func (s *BackupService) GetBackupPath(serverID, filename string) (string, error)

func (s *BackupService) ListBackups(serverID string) ([]BackupEntry, error)

type FileInfo struct {
	Name    string    `json:"name"`
	IsDir   bool      `json:"is_dir"`
	Size    int64     `json:"size"`
	ModTime time.Time `json:"mod_time"`
}

type FileService struct {
	// Has unexported fields.
}

func NewFileService(manager *minecraft.Manager, dataDir string) *FileService

func (s *FileService) CreateDirectory(serverID, path, name string) error

func (s *FileService) DeletePath(serverID, path string) error

func (s *FileService) ListFiles(serverID, path string) ([]FileInfo, error)

func (s *FileService) Unzip(serverID, path, filename string) error

func (s *FileService) UploadFile(serverID, targetPath string, fileHeader *multipart.FileHeader) error

type LogFileEntry struct {
	Name    string    `json:"name"`
	Size    int64     `json:"size"`
	ModTime time.Time `json:"mod_time"`
}

type LogService struct {
	// Has unexported fields.
}

func NewLogService(basePath string) *LogService

func (s *LogService) ListLogFiles(serverID string) ([]LogFileEntry, error)

func (s *LogService) ReadLogFile(serverID, filename string) (string, error)

type PlayerCacheItem struct {
	Name      string `json:"name"`
	UUID      string `json:"uuid"`
	ExpiresOn string `json:"expiresOn"`
	Online    bool   `json:"online"`
}

type PlayerService struct {
	Manager *minecraft.Manager
	DataDir string
}

func NewPlayerService(manager *minecraft.Manager, dataDir string) *PlayerService

func (s *PlayerService) GetBanned(serverID string) ([]minecraft.BanEntry, error)

func (s *PlayerService) GetOps(serverID string) ([]minecraft.OpEntry, error)

func (s *PlayerService) GetPlayerCache(serverID string) ([]PlayerCacheItem, error)

type SchedulerService struct {
	// Has unexported fields.
}

func NewSchedulerService(serverService *ServerService) *SchedulerService

func (s *SchedulerService) CreateTask(task *core.ScheduledTask) error

func (s *SchedulerService) DeleteTask(id string) error

func (s *SchedulerService) GetTasksByServer(serverID string) ([]core.ScheduledTask, error)

func (s *SchedulerService) LoadTasks() error

func (s *SchedulerService) ScheduleTask(task *core.ScheduledTask) error

func (s *SchedulerService) Start()

func (s *SchedulerService) Stop()

func (s *SchedulerService) UnscheduleTask(taskID string)

type ServerService struct {
	// Has unexported fields.
}

func NewServerService(m *minecraft.Manager) *ServerService

func (s *ServerService) CreateNewServer(name string, sType core.ServerType, port int, ram int) (*core.ServerConfig, error)

func (s *ServerService) GetAllServers() ([]core.ServerConfig, error)

func (s *ServerService) GetProperties(id string) (map[string]string, error)

func (s *ServerService) GetServerDetail(id string) (*core.ServerDetailResponse, error)

func (s *ServerService) GetServerLogHistory(id string) ([]string, error)

func (s *ServerService) LoadServersAtStartup() error

func (s *ServerService) SendCommand(id string, cmd string) error

func (s *ServerService) StartServer(id string) error

func (s *ServerService) StopServer(id string) error

func (s *ServerService) SubscribeConsole(id string) (chan minecraft.WSMessage, func(), error)

func (s *ServerService) UpdateProperties(id string, newProps map[string]string) error

package routes // import "github.com/ZiplEix/crafteur/routes"


FUNCTIONS

func Register(e *echo.Echo, serverCtrl *controller.ServerController, fileCtrl *controller.FileController, playerCtrl *controller.PlayerController, logCtrl *controller.LogController, backupCtrl *controller.BackupController, schedulerCtrl *controller.SchedulerController)
